<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>医生端</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

    <link rel="stylesheet" href="{{ static_url('ui/bootstrap/css/bootstrap.min.css') }}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="{{ static_url('ui/css/font-awesome.min.css') }}">
    <!-- Ionicons -->
    <link rel="stylesheet" href="{{ static_url('ui/css/ionicons.min.css') }}">
    <!-- DataTables -->
    <link rel="stylesheet" href="{{ static_url('ui/plugins/datatables/dataTables.bootstrap.css') }}">
    <!-- Theme style -->
    <link rel="stylesheet" href="{{ static_url('ui/dist/css/AdminLTE.min.css') }}">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="{{ static_url('ui/dist/css/skins/_all-skins.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('ui/plugins/iCheck/all.css') }}">
    <link rel="stylesheet" href="{{ static_url('ui/plugins/colorpicker/bootstrap-colorpicker.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('ui/plugins/select2/select2.min.css') }}">
    <link rel="stylesheet" href="{{ static_url('layer/skin/layer.css') }}">
    <link rel="stylesheet" href="{{ static_url('layer/skin/layui.css') }}">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        #head1, #head2, #footer {
            background: -webkit-linear-gradient(#9BC78F, #385c2e); /* Safari 5.1 - 6.0 */
            background: -o-linear-gradient(#9BC78F, #385C2E); /* Opera 11.1 - 12.0 */
            background: -moz-linear-gradient(#9BC78F, #385C2E); /* Firefox 3.6 - 15 */
            background: linear-gradient(#9BC78F, #385C2E); /* 标准的语法（必须放在最后） */
        }

        #jiandang, #yingyong {
            background: -webkit-linear-gradient(#D2D9C3, #A5B37E); /* Safari 5.1 - 6.0 */
            background: -o-linear-gradient(#D2D9C3, #A5B37E); /* Opera 11.1 - 12.0 */
            background: -moz-linear-gradient(#D2D9C3, #A5B37E); /* Firefox 3.6 - 15 */
            background: linear-gradient(#D2D9C3, #A5B37E); /* 标准的语法（必须放在最后） */
        }

        #jiandang:hover, #yingyong:hover {
            color: #fff;
            background: -webkit-linear-gradient(#E3E7DA, #C2CBAE); /* Safari 5.1 - 6.0 */
            background: -o-linear-gradient(#E3E7DA, #C2CBAE); /* Opera 11.1 - 12.0 */
            background: -moz-linear-gradient(#E3E7DA, #C2CBAE); /* Firefox 3.6 - 15 */
            background: linear-gradient(#E3E7DA, #C2CBAE); /* 标准的语法（必须放在最后） */

        }

        #shangchuan {
            opacity: 0;
            filter: alpha(opacity=0);
            height: 95px;
            width: 100px;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 9;
        }

        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button {
            -webkit-appearance: none !important;
        }

    </style>
</head>
<body class="hold-transition skin-green-light sidebar-mini">
{% import json %}
<div class="wrapper">

    <input type="text" class="form-control" id="moban_name" readonly="readonly"
           value="" style="display: none">
    <header class="main-header">
        <!-- Logo -->
        <a href="http://www.ict.ac.cn/" class="logo" id="head1">
            <!-- mini logo for sidebar mini 50x50 pixels -->
            <span class="logo-mini">针医堂</span>
            <!-- logo for regular state and mobile devices -->
            <span class="logo-lg"><b> 针 医 堂</b></span>
        </a>

        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" id="head2">
            <!-- Sidebar toggle button-->
            <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                    <li class="dropdown user user-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <img src="{{ static_url('ui/dist/img/user2-160x160.jpg') }}" class="user-image"
                                 alt="User Image">
                            <span class="hidden-xs">{{ current_doctor.get(u'name', u'')}}</span>
                        </a>
                        <ul class="dropdown-menu">
                            <!-- User image -->
                            <li class="user-header">
                                <img src="{{ static_url('ui/dist/img/user2-160x160.jpg') }}" class="img-circle"
                                     alt="User Image">

                                <p>
                                    {{ current_doctor.get(u'name', u'')}}
                                    <small>Member since Nov. 2016</small>
                                </p>
                            </li>
                            <!-- Menu Body -->
                            <li class="user-body">
                                <div class="row">
                                    <div class="col-xs-4 text-center">
                                        <a href="#">Followers</a>
                                    </div>
                                    <div class="col-xs-4 text-center">
                                        <a href="#">Sales</a>
                                    </div>
                                    <div class="col-xs-4 text-center">
                                        <a href="/invitation">邀请好友</a>
                                    </div>
                                </div>
                                <!-- /.row -->
                            </li>
                            <!-- Menu Footer-->
                            <li class="user-footer">
                                <div class="pull-left">
                                    <a href="#" class="btn btn-default btn-flat">Profile</a>
                                </div>
                                <div class="pull-right">
                                    <a href="/xuewei/logout" class="btn btn-default btn-flat">退出</a>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar" style="border-right:2px dotted #A5B37E;">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
            <!-- Sidebar user panel -->
            <div class="user-panel">
                <div class="pull-left image">
                    <img src="{{ static_url('ui/dist/img/user2-160x160.jpg') }}" class="img-circle" alt="User Image">
                </div>
                <div class="pull-left info">
                    <p>{{ current_doctor.get(u'name', u'')}}</p>
                    <a href="#"><i class="fa fa-circle text-success"></i> 在线</a>
                </div>
            </div>
            <!-- search form -->
            <div class="side" file="side.html"></div>
            <div class="sidebar" id="scrollspy">
                <ul class="sidebar-menu">
                    <li class="treeview" id="xuewei_classify">
                        <a href="#">
                            <i class="fa fa-fire text-red"></i> <span>穴位分类</span>
                            <span class="pull-right-container">
                              <i class="fa fa-angle-left pull-right"></i>
                            </span>
                        </a>

                    </li>
                </ul>
            </div>


        </section>
        <!-- /.sidebar -->
    </aside>
    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                证型诊断
            </h1>
            <ol class="breadcrumb">
                <li><a href="/xuewei/case_index"><i class="fa fa-dashboard"></i> 首页</a></li>
                <li class="active">证型诊断</li>
            </ol>
        </section>

        <!-- Main content -->
        <section class="content">
            <div class="row">
                <!-- /.col -->

                <div class="col-md-12">
                    <div class="box box-success" style="border-radius:8px">
                        <input id="textarea_label" style="display: none;" value="-1">
                        <div class="box-body">
                            <input type="hidden" id="hz_case_id" value="">
                            <input id="save_case_flag" class="col-sm-2 control-label"
                                   style="cursor: pointer;display: none" value="3">
                            <div class="form-horizontal" id="blxq">

                                <div class="box box-warning" style="border-radius:8px;margin-bottom:10px">
                                    <div class="box-header with-border" data-widget="collapse"
                                         style="border-radius:8px 8px 0 0;cursor: pointer">
                                        <i class="fa fa-minus"></i>
                                        <h3 class="box-title">患者症状信息</h3>
                                        <small style="margin-left:10px">点击标题部分可收缩，该部分为患者的中内、中诊信息</small>
                                    </div>
                                    <div class="box-body">
                                        <div class="form-group has-error">
                                            <label for="zn_symptom" class="col-sm-2 control-label"
                                                   style="cursor: pointer">中内</label>
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control" id="zn_symptom" placeholder="中内"
                                                       value="">
                                            </div>
                                        </div>
                                        <div class="form-group has-error">
                                            <label for="zz_symptom" class="col-sm-2 control-label"
                                                   style="cursor: pointer">中诊</label>
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control" id="zz_symptom" placeholder="中诊"
                                                       value="">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="box-footer">
                                        <div class="col-sm-2">
                                        </div>
                                        <div class="col-sm-2" style="padding-left:5px">
                                            <button class="btn btn-success" onclick="diagnose()">确 定</button>
                                        </div>

                                </div>
                                </div>
                                <div class="box box-success"
                                     style="border-radius:8px;border-color:#A5B37E;margin-bottom:10px;">
                                    <div class="box-header with-border" data-widget="collapse"
                                         style="border-radius:8px 8px 0 0;cursor: pointer">
                                        <i class="fa fa-minus"></i>
                                        <h3 class="box-title">诊断与治疗</h3>
                                        <small style="margin-left:10px">点击标题部分可收缩，该部分为系统预测信息</small>
                                    </div>
                                    <div class="box-body">
                                        <div class="form-group has-success">
                                            <label for="bianzheng" class="col-sm-2 control-label" style="cursor: pointer">中医辨证</label>
                                            <div class="col-sm-8">
                                                <textarea type="text" class="form-control" rows="3" id="bianzheng" placeholder="中医辨证" ></textarea>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /. box -->
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

     <div class="footer"></div>

</div>


<script src='{{ static_url("ui/plugins/jQuery/jquery-2.2.3.min.js") }}'></script>
<!-- Bootstrap 3.3.6 -->
<script src='{{ static_url("ui/bootstrap/js/bootstrap.min.js") }}'></script>
<!-- DataTables -->
<script src="{{ static_url('ui/plugins/datatables/jquery.dataTables1.min.js') }}"></script>
<script src="{{ static_url('ui/plugins/datatables/dataTables.bootstrap.min.js') }}"></script>
<!-- SlimScroll -->
<script src="{{ static_url('ui/plugins/slimScroll/jquery.slimscroll.min.js') }}"></script>
<!-- FastClick -->
<script src="{{ static_url('ui/plugins/fastclick/fastclick.js') }}"></script>
<!-- AdminLTE App -->
<script src="{{ static_url('ui/dist/js/app.min.js') }}"></script>
<!-- AdminLTE for demo purposes -->
<script src="{{ static_url('ui/dist/js/demo.js') }}"></script>
<script src="{{ static_url('layer/layer.js') }}"></script>
<script src="{{ static_url('layer/layui.js') }}"></script>

<!-- Page specific script -->
<script>
    $(function () {
        $("#case_table").DataTable({
            "searching": false,
            "ordering": false,
            "iDisplayLength": 5
        });
        $('.side').load('/xuewei/side');
        $('.footer').load('/xuewei/footer');
        $.ajax({
            type: "post",
            async: true,
            url: "/xuewei/symptom",
            data: '',
            dataType: "json",
            timeout: 1000,
            success: function (datas) {
                console.log(datas);
                var ul_str='<ul class="treeview-menu">';
                for(var item in datas){
                    //console.log(item);
                    if(item=="中内"){
                        ul_str+='<li class="treeview"><a style="cursor:pointer"><i class="fa fa-tags text-red" style="color:#E36C59 !important"></i>' + item + '</a><ul class="treeview-menu">';
                        for(var its in datas[item]){
                           // console.log(its);
                            ul_str+='<li class="treeview"><a style="cursor:pointer"><i class="fa fa-tags text-orange"></i>'+its+'</a><ul class="treeview-menu">';

                            for(var i of datas[item][its]){
                                //console.log(i);
                                ul_str+='<li class="treeview"><a style="cursor:pointer" onclick="znSypmtom(\''+ i +'\')"><i class="fa fa-tag text-yellow"></i>'+i+'</a></li>';
                            }
                            ul_str+='</ul></li>';
                        }
                        ul_str+='</ul></li>';
                    }
                    else{
                        ul_str+='<li class="treeview"><a style="cursor:pointer"><i class="fa fa-tags text-red" style="color:#E36C59 !important"></i>' + item + '</a><ul class="treeview-menu">';
                        for(var its in datas[item]){
                           // console.log(its);
                            ul_str+='<li class="treeview"><a style="cursor:pointer"><i class="fa fa-tags text-orange"></i>'+its+'</a><ul class="treeview-menu">';

                            for(var i of datas[item][its]){
                                //console.log(i);
                                ul_str+='<li class="treeview"><a style="cursor:pointer" onclick="zzSypmtom(\''+ i +'\')"><i class="fa fa-tag text-yellow"></i>'+i+'</a></li>';
                            }
                            ul_str+='</ul></li>';
                        }
                        ul_str+='</ul></li>';
                    }
                }
                ul_str+='</ul>';
                $(ul_str).appendTo($("#xuewei_classify"));
            },
            error: function (datas) {
            }
        });
    });
</script>
<script>
    $(document).ready(function () {

    });
    function znSypmtom(data){
        console.log(data);
        var zn_symptom_str=$("#zn_symptom").val();
        var zn_symptom_final_str='';
        if(zn_symptom_str==""){
            zn_symptom_final_str+=data;
        }else{
            zn_symptom_final_str+=zn_symptom_str+','+data;
        }
        $("#zn_symptom").val(zn_symptom_final_str);
    }
    function zzSypmtom(data){
        console.log(data);
        var zz_symptom_str=$("#zz_symptom").val();
        var zz_symptom_final_str='';
        if(zz_symptom_str==""){
            zz_symptom_final_str+=data;
        }else{
            zz_symptom_final_str+=zz_symptom_str+','+data;
        }
        $("#zz_symptom").val(zz_symptom_final_str);
    }
    function diagnose(){
        var zn_symptom_content=$("#zn_symptom").val();
        var zz_symptom_content=$("#zz_symptom").val();
        var symptom_content={};
        symptom_content["zn_symptom_content"]=zn_symptom_content;
        symptom_content["zz_symptom_content"]=zz_symptom_content;
        //console.log(symptom_content);
        //var json_str = $.toJSON(symptom_content);
        var final_strs=zn_symptom_content+','+zz_symptom_content;
        console.log(final_strs);
        var url="/xuewei/diagnose";
        $.ajax({
            type: "post",
            async: true,
            url: url,
            data: {"symptoms":final_strs},
            dataType: "json",
            timeout: 1000,
            success: function (datas) {
                console.log(datas);
                $("#bianzheng").val(datas);
            }
        });
    }
</script>
<script>
    function blreport() {
        layer.open({
            type: 2,
            title: '诊断报告',
            closeBtn: 1,
            shadeClose: false,
            shade: 0.3,
            maxmin: true, //开启最大化最小化按钮
            area: ['80%', '90%'],
            anim: 2,
            content: '/diagnosis_report',
            end: function () {
            }
        });
    }

    function show_info(id) {
        var content = $("#" + id).val();
        layer.alert(content);
    }

    function show_big_skin_images(path, disease) {
        layer.photos({
            photos: {
                "data": [{
                    "alt": disease + " 的临床医学图片",
                    "src": path
                }]
            }
        });
    }

    function show_report(caseID) {
        layer.open({
            type: 2,
            title: '历史诊断报告',
            closeBtn: 1,
            shadeClose: false,
            shade: 0.3,
            maxmin: true, //开启最大化最小化按钮
            area: ['80%', '90%'],
            anim: 2,
            content: '/diagnosis_history_report?caseID=' + caseID,
            end: function () {
            }
        });
    }
</script>
</body>
</html>