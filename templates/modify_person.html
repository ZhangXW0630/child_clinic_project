<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>医生端</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

    <link rel="stylesheet" href="{{static_url('ui/bootstrap/css/bootstrap.min.css')}}">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="{{static_url('ui/css/font-awesome.min.css')}}">
  <!-- Ionicons -->
  <link rel="stylesheet" href="{{static_url('ui/css/ionicons.min.css')}}">
  <!-- DataTables -->
  <link rel="stylesheet" href="{{static_url('ui/plugins/datatables/dataTables.bootstrap.css')}}">
  <!-- Theme style -->
  <link rel="stylesheet" href="{{static_url('ui/dist/css/AdminLTE.min.css')}}">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="{{static_url('ui/dist/css/skins/_all-skins.min.css')}}">
  <link rel="stylesheet" href="{{static_url('ui/plugins/iCheck/all.css')}}">
  <link rel="stylesheet" href="{{static_url('ui/plugins/colorpicker/bootstrap-colorpicker.min.css')}}">
   <link rel="stylesheet" href="{{static_url('ui/plugins/select2/select2.min.css')}}">
    <link rel="stylesheet" href="{{static_url('layer/skin/layer.css')}}">
        <link rel="stylesheet" href="{{static_url('layer/skin/layui.css')}}">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        #head1,#head2,#footer {
            background: -webkit-linear-gradient(#9BC78F, #385C2E); /* Safari 5.1 - 6.0 */
            background: -o-linear-gradient(#9BC78F, #385C2E); /* Opera 11.1 - 12.0 */
            background: -moz-linear-gradient(#9BC78F, #385C2E); /* Firefox 3.6 - 15 */
            background: linear-gradient(#9BC78F, #385C2E); /* 标准的语法（必须放在最后） */
        }
        #jiandang,#yingyong{
            background: -webkit-linear-gradient(#D2D9C3, #A5B37E); /* Safari 5.1 - 6.0 */
            background: -o-linear-gradient(#D2D9C3, #A5B37E); /* Opera 11.1 - 12.0 */
            background: -moz-linear-gradient(#D2D9C3, #A5B37E); /* Firefox 3.6 - 15 */
            background: linear-gradient(#D2D9C3, #A5B37E); /* 标准的语法（必须放在最后） */
        }
        #jiandang:hover,#yingyong:hover{
            color: #fff;
            background: -webkit-linear-gradient(#E3E7DA, #C2CBAE); /* Safari 5.1 - 6.0 */
            background: -o-linear-gradient(#E3E7DA, #C2CBAE); /* Opera 11.1 - 12.0 */
            background: -moz-linear-gradient(#E3E7DA, #C2CBAE); /* Firefox 3.6 - 15 */
            background: linear-gradient(#E3E7DA, #C2CBAE); /* 标准的语法（必须放在最后） */

        }
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }
    </style>
</head>
<body >
{% import json %}

        <!-- Content Header (Page header) -->
        <!-- Main content -->
        <section class="content">
                <!-- /.col -->
                <div class="col-md-12">
                    <div class="box box-success" style="border-radius:8px">
                        <div class="box-body">
                            <div class="form-horizontal">
                                <div class="form-group has-feedback">
                                    <label for="b_patientName" class="col-sm-2 control-label"  style="cursor: pointer" >姓名</label>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control" id="b_patientName" placeholder="姓名" value="{{patient_dict.get(u'name', u'')}}">

                                        <span class="fa fa-asterisk text-red form-control-feedback"></span>
                                    </div>
                                    <label for="b_telephone" class="col-sm-2 control-label"  style="cursor: pointer" onclick="">手机号</label>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control" id="b_telephone" placeholder="手机号" value="{{patient_dict.get(u'telephone', u'')}}" >
                                        <span class="fa fa-asterisk text-red form-control-feedback"></span>
                                    </div>
                                </div>
                                <div class="form-group has-feedback">
                                    <label for="b_ID_Card" class="col-sm-2 control-label"  style="cursor: pointer" >身份证号</label>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control" id="b_ID_Card" placeholder="身份证号" value="{{patient_dict.get(u'identityCardNum', u'')}}">
                                        <span class="fa fa-asterisk text-red form-control-feedback"></span>
                                    </div>
                                    <label for="b_socialID" class="col-sm-2 control-label"  style="cursor: pointer" onclick="">社保号</label>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control" id="b_socialID" placeholder="社保号" value="{{patient_dict.get(u'socialSecurityNum', u'')}}">
                                    </div>
                                </div>
                                <div class="form-group has-feedback">
                                    <label for="b_patientSex" class="col-sm-2 control-label"  style="cursor: pointer" >性别</label>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control" id="b_patientSex" placeholder="性别"  value="{{patient_dict.get(u'sex', u'')}}">
                                        <span class="fa fa-asterisk text-red form-control-feedback"></span>
                                    </div>
                                    <label for="b_patientAge" class="col-sm-2 control-label"  style="cursor: pointer" onclick="">年龄</label>
                                    <div class="col-sm-3">
                                        <input type="number" class="form-control" id="b_patientAge" placeholder="年龄" value="{{patient_dict.get(u'age', u'')}}">
                                        <span class="fa fa-asterisk text-red form-control-feedback"></span>
                                    </div>
                                </div>
                                <div class="form-group has-feedback">

                                    <div class="col-sm-4">

                                    </div>
                                    <div class="col-sm-2">
                                        <button  id="confirm" onclick="updatePatient({{patient_dict.get(u'patientID', u'')}})" class="btn btn-success btn-block" style="background-color:#9BC78F;color:#000;border-color:#8DBD7F">
                                            <b>确认修改</b>
                                        </button>
                                    </div>
                                    <div class="col-sm-2">
                                        <button  id="cancel" onclick="cancel()" class="btn btn-success btn-block" style="background-color:#9BC78F;color:#000;border-color:#8DBD7F">
                                            <b>取消</b>
                                        </button>
                                    </div>

                                </div>

                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /. box -->
                </div>
            <!-- /.row -->
        </section>
        <!-- /.content -->
<script src="{{static_url('ui/plugins/jQuery/jquery-2.2.3.min.js')}}"></script>
<!-- Bootstrap 3.3.6 -->
<script src="{{static_url('ui/bootstrap/js/bootstrap.min.js')}}"></script>
<!-- DataTables -->
<script src="{{static_url('ui/plugins/datatables/jquery.dataTables1.min.js')}}"></script>
<script src="{{static_url('ui/plugins/datatables/dataTables.bootstrap.min.js')}}"></script>
<!-- SlimScroll -->
<script src="{{static_url('ui/plugins/slimScroll/jquery.slimscroll.min.js')}}"></script>
<!-- FastClick -->
<script src="{{static_url('ui/plugins/fastclick/fastclick.js')}}"></script>
<!-- AdminLTE App -->
<script src="{{static_url('ui/dist/js/app.min.js')}}"></script>
<!-- AdminLTE for demo purposes -->
<script src="{{static_url('ui/dist/js/demo.js')}}"></script>
<script src="{{static_url('layer/layui.js')}}"></script>
<script src="{{static_url('layer/layer.js')}}"></script>
<!-- Page specific script -->


<script>
layui.use('laydate', function(){
  var laydate = layui.laydate;

  var start = {
    min: '1976-01-01 00:00:00'
    ,max: '2099-06-16 23:59:59'
    ,istoday: false
    ,choose: function(datas){
      end.min = datas; //开始日选好后，重置结束日的最小日期
      end.start = datas //将结束日的初始值设定为开始日
    }
  };

  var end = {
    min: '1976-01-01 00:00:00'
    ,max: '2099-06-16 23:59:59'
    ,istoday: false
    ,choose: function(datas){
      start.max = datas; //结束日选好后，重置开始日的最大日期
    }
  };

  document.getElementById('LAY_demorange_s').onclick = function(){
    start.elem = this;
    laydate(start);
  }
  document.getElementById('LAY_demorange_e').onclick = function(){
    end.elem = this
    laydate(end);
  }

});
</script>


<script>
    $(function () {
    $("#case_table").DataTable({
		"searching": false,
		"ordering": false,
        "iDisplayLength": 5
	});

  });
</script>


<script>
    function updatePatient(patientID) {
        var patient_info = {};
        patient_info["patientID"] = patientID;
        patient_info["name"] = $("#b_patientName").val();
        patient_info["telephone"] = $("#b_telephone").val();
        patient_info["identityCardNum"] = $("#b_ID_Card").val();
        patient_info["socialSecurityNum"] = $("#b_socialID").val();
        patient_info["sex"] = $("#b_patientSex").val();
        patient_info["age"] = $("#b_patientAge").val();
        var fail = 0;
        if (patient_info["name"] == "" || patient_info["telephone"] == "" || patient_info["identityCardNum"] == ""
            || patient_info["sex"] == "" || patient_info["age"] == "") {
            fail = -1;
            alert("带红色星号的不能为空!");
        }
        patient_info["caseFirstID"] = parent.$('#hz_case_id').val().split('.')[0];
        patient_info["caseSecondID"] = parent.$("#hz_case_id").val().split('.')[1];
        if (fail != -1) {
            var url = "/modify_person";
            $.ajax({
                        type: "post",
                        async: true,
                        url: url,
                        data: patient_info,
                        dataType: "json",
                        timeout: 1000,
                        success: function (datas) {
                            var index = parent.layer.getFrameIndex(window.name);
                            parent.layer.close(index);
//                          parent.layer.alert('患者个人信息更新成功！');
                        },
                        error: function (datas) {
                            parent.layer.alert('患者个人信息更新失败！');
                        }
                    });

        }

    }
    function cancel() {
        var index = parent.layer.getFrameIndex(window.name);
          parent.layer.close(index);
    }
</script>



</body>
</html>
